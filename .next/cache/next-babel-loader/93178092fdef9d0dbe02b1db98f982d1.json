{"ast":null,"code":"import Cookies from 'js-cookie';\nimport fetch from 'isomorphic-unfetch';\nimport { handleResponse } from '../_helpers';\nlet currentUserSubject = Cookies.getJSON('currentUser') ? Cookies.getJSON('currentUser') : {};\nconst target = `https://intim-vibe-api.padilo.pro/api`;\nexport const authenticationService = {\n  login,\n  logout,\n  registrationAdmin,\n  registrationClient,\n  registrationProvider,\n  confirmEmail,\n  confirmSMS,\n  currentUser: currentUserSubject,\n\n  get currentUserValue() {\n    return currentUserSubject;\n  }\n\n};\n\nasync function login(email, password) {\n  return await fetch(`${target}/login`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n      email,\n      password\n    })\n  }).then(handleResponse).then(user => {\n    // if (user.token) {\n    Cookies.set('currentUser', JSON.stringify(user));\n    currentUserSubject = user;\n    return user; // }\n  }).catch(err => console.error('Error:', err)); // .then(() => window.location.reload(true));\n}\n\nasync function registrationClient(name, password, email, password_confirmation) {\n  // https://intim-vibe-api.padilo.pro/api/client/register\n  return await fetch(`https://intim-vibe-api.padilo.pro/api/client/register`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n      name,\n      password,\n      email,\n      password_confirmation\n    })\n  }).then(handleResponse).then(client => {\n    console.log('client:', client);\n    Cookies.set('currentUser', JSON.stringify(client));\n    currentUserSubject = client;\n    return client;\n  }).catch(err => console.error('Error:', err));\n}\n\nasync function registrationAdmin(name, password, email, password_confirmation) {\n  return await fetch(`${target}/admin/register`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n      name,\n      password,\n      email,\n      password_confirmation\n    })\n  }).then(handleResponse).then(admin => {\n    Cookies.set('currentUser', JSON.stringify(admin));\n    currentUserSubject = admin;\n    return admin;\n  }).catch(err => console.error('Error:', err));\n}\n\nasync function registrationProvider(name, password, email, password_confirmation, phone) {\n  return await fetch(`${target}/individual/register`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n      name,\n      password,\n      email,\n      password_confirmation,\n      phone\n    })\n  }).then(handleResponse).then(provider => {\n    Cookies.set('currentUser', JSON.stringify(provider));\n    currentUserSubject = provider;\n    return provider;\n  }).catch(err => console.error('Error:', err));\n}\n\nasync function logout() {\n  Cookies.remove('currentUser');\n  return await fetch(`${target}/logout`, {\n    method: 'GET',\n    mode: 'no-cors',\n    headers: {\n      'Content-Type': 'application/json',\n      'Access-Control-Allow-Origin': '*'\n    }\n  }).then(res => res).catch(err => console.error('Error:', err));\n}\n\nfunction confirmEmail(token) {\n  const requestOptions = {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json'\n    }\n  };\n  return fetch(`/register/activate_email/${token}`, requestOptions).then(handleResponse).catch(err => console.error('Error:', err));\n}\n\nfunction confirmSMS(token) {\n  const requestOptions = {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json'\n    }\n  };\n  return fetch(`/register/activate_sms/${token}`, requestOptions).then(handleResponse).catch(err => console.error('Error:', err));\n}","map":null,"metadata":{},"sourceType":"module"}